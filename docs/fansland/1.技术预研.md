> 关联文档： [14.海外版NFTSaaS.md](../14.海外版NFTSaaS.md)

# 技术预研

## 做什么？

- 传统：Web2部分——演唱会门票网站
  - 功能：
    - 门票网站的必要功能
    - Web端、H5端
  - 对标网站：
    - 国内： [摩天轮](https://www.moretickets.com/)
    - 国外：
      - [ticketmelon](https://www.ticketmelon.com/)
- 创新：Web3部分——NFT交易平台
  - 功能：
    - 融合"NFT+门票"
    - 支持NFT二手交易
    - USDT支付
    - 支持数藏玩法
    - 能上OpenSea
  - 对标：
      - Yellow Heart: https://yh.io/

## 市面同类产品

- YellowHeart:
  - 官网：https://yh.io/
  - [yellowheart白皮书](yellowheart-protocol-whitepaper.pdf)
- https://nftconcerts.com/



## 几个思考
- 中心化和去中心化？
- 如果用合约实现多种玩法，成本问题如何解决？

## 功能模块（粗略）

![](../imgs/fansland-modules.png)



## 技术细节研究

### Metamask登录


> 参考： https://zh.socialgekon.com/one-click-login-with-blockchain



后端需要在用户表中增加`address`和`nonce`字段。兼容其他登录方式，如邮件、facebook登录

| 字段 | 类型 | 说明|
|-----|-----|-----|
| address | varchar(42)| 账户地址, 唯一, 例如：`0xf513e4e5Ded9B510780D016c482fC158209DE9AA`|
| nonce| varchar(100) | 随机数，每次登录都随机生成,且不会重复， 例如签名消息：`1_0xf513e4e5ded9b510780d016c482fc158209de9aa_29933_1672989603538`|


![](../imgs/metamask-login.jpg)

### 账户模型


参考yellowheart, 用户以邮件作为主要登录方式,绑定Metamask账户，Metamask用作ETH或USDC支付

![](../imgs/yellowheart-wallet.jpeg)




### 支付方式

参考yellowheart, 支持信用卡、ETH两种支付方式:

![](../imgs/yellowheart-payment.png )


虽然NFT是在Polygon发行，但是，其中ETH使用Metamask账户的ETH余额进行支付。

信用卡支付：

![](../imgs/yellowheart-credit.png)



yellowheart的ETH支付（分账）流程:

ETH和USDC收款合约地址： https://etherscan.io/address/0x53c663cdb68689089f3fea3e586a7e4552b72e52


没有找到分账交易，yellowheart应该是直接收取ETH或USDC，然后从自己的法币账户转账给用户（卖家），同时扣除手续费。


用加密货币（ETH、USDC）购买NFT的流程：

```mermaid
sequenceDiagram
     NFT门票卖家 ->> + YellowHeart: 1）挂单
     NFT门票买家 ->> + YellowHeart: 2）在Ethereum上用ETH或USDC购买NFT
     YellowHeart -->> -  NFT门票买家: 3）在Polygon链上转移NFT给卖家
     YellowHeart ->> + YellowHeart: 4）扣除手续费
     YellowHeart -->>   NFT门票卖家: 5） 转法币给到卖家银行卡

```

平台接收ETH、USDC，需要承担币价波动的风险。


### 钱包功能

![](../imgs/yellowheart-wallet-assets.jpeg)


- Ethereum
  - ETH
  - USDC
  - HRTS： yellowheart发行的币
- Polygon
  - WETH


### 二级市场

用户可以将自己的NFT门票挂单卖出，可以设置版税。同OpenSea



